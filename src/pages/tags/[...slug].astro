---
import { getCollection } from "astro:content";
import DocPageLayout from "@/layouts/DocPageLayout.astro";

export async function getStaticPaths() {
  const blogEntries = await getCollection("docs");
  const tags = [...new Set(blogEntries.flatMap((entry) => entry.data.tags))];
  return tags.map((tag) => ({
    params: {
      slug: tag,
    },
    props: { tag },
  }));
}
const { tag } = Astro.props;
const taggedEntries = (await getCollection("docs")).filter((entry) =>
  entry.data.tags.includes(tag)
);
---

<DocPageLayout title={`All pages for tag "${tag}"`}>
  <ul class="list-disc list-inside">
    {
      taggedEntries.map((entry) => (
        <li>
          <a
            class="underline"
            href={[
              "/docs",
              entry.slug.toLowerCase(),
            ].join("/")}
          >
            {entry.data.title}
          </a>
        </li>
      ))
    }
    <ul></ul>
  </ul>
</DocPageLayout>
